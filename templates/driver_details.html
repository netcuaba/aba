{% extends "base.html" %}

{% block title %}Chi ti·∫øt chuy·∫øn - {{ driver_name }} - H·ªá th·ªëng qu·∫£n l√Ω v·∫≠n chuy·ªÉn{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
    <a href="/salary" class="btn" style="background: #95a5a6; text-decoration: none; display: inline-flex; align-items: center; gap: 8px;">
        ‚Üê Quay l·∫°i trang l∆∞∆°ng
    </a>
</div>

<h2>üìã Chi ti·∫øt chuy·∫øn c·ªßa {{ driver_name }}</h2>

<!-- Th√¥ng tin t·ªïng quan -->
<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 15px; color: white; margin-bottom: 30px;">
    <h3 style="margin-bottom: 20px;">üìä Th·ªëng k√™ {{ period_text }}</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
        <div style="text-align: center;">
            <h4 style="font-size: 2em; margin-bottom: 5px;">{{ total_trips }}</h4>
            <p>T·ªïng chuy·∫øn</p>
        </div>
        <div style="text-align: center;">
            <h4 style="font-size: 2em; margin-bottom: 5px;">{{ "{:,.1f}".format(total_distance) }}</h4>
            <p>T·ªïng km</p>
        </div>
        <div style="text-align: center;">
            <h4 style="font-size: 2em; margin-bottom: 5px;">{{ "{:,.1f}".format(total_cargo) }}</h4>
            <p>T·ªïng t·∫£i tr·ªçng (kg)</p>
        </div>
        <div style="text-align: center;">
            <h4 style="font-size: 2em; margin-bottom: 5px;">{{ routes_used|length }}</h4>
            <p>Tuy·∫øn ƒë√£ ch·∫°y</p>
        </div>
    </div>
</div>

<!-- C√°c tuy·∫øn ƒë√£ ch·∫°y -->
{% if routes_used %}
<div style="background: rgba(39, 174, 96, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #27ae60;">
    <h4 style="color: #27ae60; margin-bottom: 15px;">üõ£Ô∏è C√°c tuy·∫øn ƒë√£ ch·∫°y</h4>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        {% for route in routes_used %}
        <span style="background: rgba(39, 174, 96, 0.2); color: #27ae60; padding: 8px 15px; border-radius: 20px; font-size: 0.9em; font-weight: 500;">
            {{ route }}
        </span>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- B·∫£ng chi ti·∫øt chuy·∫øn -->
{% if daily_routes %}
<div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <h4 style="color: #2c3e50; margin-bottom: 20px;">üìÖ Danh s√°ch chuy·∫øn chi ti·∫øt</h4>
    
    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <thead>
                <tr style="background: linear-gradient(135deg, #3498db, #2980b9); color: white;">
                    <th style="padding: 15px; text-align: center; font-weight: 600;">Ng√†y ch·∫°y</th>
                    <th style="padding: 15px; text-align: center; font-weight: 600;">M√£ tuy·∫øn</th>
                    <th style="padding: 15px; text-align: center; font-weight: 600;">T√™n tuy·∫øn</th>
                    <th style="padding: 15px; text-align: center; font-weight: 600;">Bi·ªÉn s·ªë xe</th>
                    <th style="padding: 15px; text-align: center; font-weight: 600;">Km</th>
                    <th style="padding: 15px; text-align: center; font-weight: 600;">T·∫£i tr·ªçng (kg)</th>
                    <th style="padding: 15px; text-align: center; font-weight: 600;">Ghi ch√∫</th>
                </tr>
            </thead>
            <tbody>
                {% for trip in daily_routes %}
                <tr style="border-bottom: 1px solid #ecf0f1; transition: background-color 0.2s;">
                    <td style="padding: 15px; font-weight: 500; color: #2c3e50;">
                        <span style="background: rgba(52, 152, 219, 0.1); color: #3498db; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">
                            {{ trip.date.strftime('%d/%m/%Y') }}
                        </span>
                    </td>
                    <td style="padding: 15px;">
                        <span style="background: rgba(39, 174, 96, 0.1); color: #27ae60; padding: 5px 10px; border-radius: 15px; font-size: 0.9em; font-weight: 500;">
                            {{ trip.route.route_code }}
                        </span>
                    </td>
                    <td style="padding: 15px; color: #2c3e50;">{{ trip.route.route_name }}</td>
                    <td style="padding: 15px;">
                        <span style="background: rgba(155, 89, 182, 0.1); color: #9b59b6; padding: 5px 10px; border-radius: 15px; font-size: 0.9em; font-weight: 500;">
                            {{ trip.license_plate }}
                        </span>
                    </td>
                    <td style="padding: 15px; text-align: right; font-weight: 500; color: #e67e22;">
                        {{ "{:,.1f}".format(trip.distance_km) }}
                    </td>
                    <td style="padding: 15px; text-align: right; font-weight: 500; color: #e67e22;">
                        {{ "{:,.1f}".format(trip.cargo_weight) }}
                    </td>
                    <td style="padding: 15px; color: #7f8c8d; font-style: italic;">
                        {{ trip.notes or '-' }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot style="background: rgba(52, 73, 94, 0.1); font-weight: bold;">
                <tr>
                    <td colspan="4" style="padding: 15px; text-align: right;"><strong>T·ªîNG C·ªòNG</strong></td>
                    <td style="padding: 15px; text-align: right; color: #e67e22;">
                        <strong>{{ "{:,.1f}".format(total_distance) }}</strong>
                    </td>
                    <td style="padding: 15px; text-align: right; color: #e67e22;">
                        <strong>{{ "{:,.1f}".format(total_cargo) }}</strong>
                    </td>
                    <td style="padding: 15px;"></td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>
{% else %}
<div style="text-align: center; padding: 40px; color: #7f8c8d; background: rgba(255, 255, 255, 0.9); border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <h3>üìÖ Ch∆∞a c√≥ d·ªØ li·ªáu chuy·∫øn</h3>
    <p>L√°i xe {{ driver_name }} ch∆∞a c√≥ chuy·∫øn n√†o ƒë∆∞·ª£c ghi nh·∫≠n {{ period_text }}</p>
    <div style="margin-top: 20px;">
        <a href="/daily" class="btn" style="background: #3498db;">Ghi nh·∫≠n chuy·∫øn</a>
        <a href="/salary" class="btn" style="background: #95a5a6; margin-left: 10px;">Quay l·∫°i</a>
    </div>
</div>
{% endif %}

<!-- Th√¥ng tin h∆∞·ªõng d·∫´n - ƒê√£ ·∫©n -->
<div style="display: none; margin-top: 30px; padding: 20px; background: rgba(241, 196, 15, 0.1); border-radius: 10px; border-left: 4px solid #f1c40f;">
    <h4 style="color: #f39c12; margin-bottom: 10px;">üí° Th√¥ng tin chi ti·∫øt:</h4>
    <div style="color: #2c3e50; line-height: 1.6;">
        <p><strong>B√°o c√°o chi ti·∫øt chuy·∫øn v·∫≠n chuy·ªÉn c·ªßa {{ driver_name }}</strong></p>
        <ul style="margin-top: 10px;">
            <li><strong>Ng√†y ch·∫°y:</strong> Ng√†y th·ª±c hi·ªán chuy·∫øn v·∫≠n chuy·ªÉn</li>
            <li><strong>M√£ tuy·∫øn:</strong> M√£ ƒë·ªãnh danh c·ªßa tuy·∫øn ƒë∆∞·ªùng</li>
            <li><strong>T√™n tuy·∫øn:</strong> T√™n m√¥ t·∫£ c·ªßa tuy·∫øn ƒë∆∞·ªùng</li>
            <li><strong>Bi·ªÉn s·ªë xe:</strong> Bi·ªÉn s·ªë xe s·ª≠ d·ª•ng cho chuy·∫øn</li>
            <li><strong>Km:</strong> Qu√£ng ƒë∆∞·ªùng th·ª±c t·∫ø ƒë√£ ch·∫°y</li>
            <li><strong>T·∫£i tr·ªçng:</strong> Tr·ªçng l∆∞·ª£ng h√†ng h√≥a v·∫≠n chuy·ªÉn</li>
        </ul>
    </div>
</div>

<!-- N√∫t in b√°o c√°o -->
{% if daily_routes %}
<div style="margin-top: 20px; text-align: center;">
    <button onclick="window.print()" class="btn" style="background: #27ae60; padding: 12px 24px; font-size: 1.1em;">
        üñ®Ô∏è In b√°o c√°o
    </button>
</div>
{% endif %}

<style>
@media print {
    .btn, a[href] {
        display: none !important;
    }
    
    body {
        background: white !important;
    }
    
    .table, table {
        box-shadow: none !important;
        border: 1px solid #ddd !important;
    }
    
    h2, h3, h4 {
        color: black !important;
    }
}
</style>
{% endblock %}
